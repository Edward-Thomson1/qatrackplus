{% extends "site_base.html" %}

{% block body %}

    <h2>{{unit_task_list.unit.name}} {{frequency|title}} Task Lists</h2>

    <table class="table table-bordered table-striped table-condensed span6">

        <thead>
            <tr>
                <th>Task List</th>
                <th>{{ frequency|title }} QA Last Performed</th>
                <th>QA Status</th>
                <th>Perform</th>
            </tr>
        </thead>
        <tbody>
        {% for task_list in unit_task_list.task_lists.all %}
            <tr>
                <td>{{task_list.name|title}}</td>
                {% with last_completed=task_list.last_completed_instance %}
                {% if last_completed %}
                        <td>{{last_completed.work_completed}}</td>
                        <td>
                            {% for status,display,tests in last_completed.status %}
                                {% if tests.count > 0 %}
                                <span class="{{status}}">{{tests.count}} {{display}}</span>
                                {% endif %}
                            {% endfor %}
                        </td>
                    {% else %}
                        <td><span class="btn-info disabled">New Task List</span></td>
                        <td><span class="btn-info disabled">New Task List</span></td>
                    {% endif %}
                 {% endwith %}
                 <td><a href="{%url perform_qa frequency=frequency type="task_list" pk=task_list.pk unit_number=unit_task_list.unit.number %}">Perform</a></td>
            </tr>
        {% endfor %}

        {% for cycle_ in unit_task_list.cycles.all %}
            <tr>
                <td>{{cycle_.name|title}}</td>
                {% with last_completed=cycle_.last_completed_instance %}
                {% if last_completed %}
                        <td>{{last_completed.work_completed}}</td>
                        <td>
                            {% for status,display,tests in last_completed.status %}
                                {% if tests.count > 0 %}
                                <span class="{{status}}">{{tests.count}} {{display}}</span>
                                {% endif %}
                            {% endfor %}
                        </td>
                    {% else %}
                        <td><span class="btn-info disabled">New Task List</span></td>
                        <td><span class="btn-info disabled">New Task List</span></td>
                    {% endif %}
                 {% endwith %}
                 <td><a href="{%url perform_qa frequency=frequency type="cycle" pk=cycle_.pk unit_number=unit_task_list.unit.number%}?day=next">Perform</a></td>
            </tr>
        {% endfor %}

        </tbody>
    </table>
{% endblock %}
