{% extends "site_base.html" %}

{% load staticfiles %}

{% block head_title %}QA Data Charts{% endblock %}

{% block extra_style %}
    <link href="{% static "css/charts.css" %}?v={{VERSION}}" rel="stylesheet">
    <link href="{% static "datepicker/css/datepicker.css" %}?v={{VERSION}}" rel="stylesheet">
    <link href="{% static "data_tables/css/DT_bootstrap.css" %}?v={{VERSION}}" rel="stylesheet">
{% endblock %}

{% block extra_script %}

    <script src="{% static "js/underscore-min.js" %}?v={{VERSION}}"></script>
	<script src="{% static "js/highstock/highstock.js" %}?v={{VERSION}}"></script>
	<script src="{% static "js/highstock/highcharts-more.js" %}?v={{VERSION}}"></script>
    <script src="{% static "datepicker/js/bootstrap-datepicker.js" %}?v={{VERSION}}"></script>

	<script>
		var QACharts = {
			data_url:"{{chart_data_url}}",
			control_chart_url:"{{control_chart_url}}",
			test_info:{{test_data|safe}}
		};
	</script>

    <script src="{% static "js/charts.js" %}?v={{VERSION}}"></script>
{% endblock %}

{% block body %}

<div class="row-fluid">
	<div class="span12">
		<h3>Trending</h3>
	</div>
</div>
<div class="row-fluid">

	<div class="span2">
		<div id="unit-container" class="control-container">
			<h5>1. Choose Units</h5>
			<div class="checkbox-container checkbox-filter">
				{% for unit in units %}
					<label class="checkbox" title="{{test_list.name}}" >
						<input type="checkbox" id="unit-{{unit.pk}}" name="unit[]" value="{{unit.pk}}" title="{{unit.name}}" class="unit unit-type-{{unit.type.pk}}"></input>
						{{unit.name}}
					</label>
				{% endfor %}
			</div>
		</div>
	</div>
	<div class="span2">
		<div id="frequency-container" class="control-container">
			<h5>2. Choose Frequencies</h5>
			<div class="checkbox-container checkbox-filter">
				{% for frequency in frequencies %}
					<label class="checkbox" title="{{frequency.name}}" >
						<input type="checkbox" id="frequency-{{frequency.pk}}" name="frequency[]" value="{{frequency.pk}}" checked="checked" class="frequency"></input>
						{{frequency.name}}
					</label>
				{% endfor %}
			</div>
		</div>
	</div>
	<div class="span2">
		<div id="test-list-container" class="control-container">
			<h5>3. Choose Test Lists</h5>

			<div class="checkbox-container checkbox-filter">
				{% for test_list in test_lists %}
					<label class="checkbox" title="{{test_list.name}}" >
						<input type="checkbox" id="test-list-{{test_list.pk}}" name="test-list[]" value="{{test_list.pk}}" title="{{test_list.description}}"  class="test-list"></input>
						{{test_list.name}}
					</label>
				{% endfor %}
			</div>
		</div>
	</div>
	<div class="span2">
		<div id="test-container" class="control-container">
			<h5>4. Choose Tests to Plot</h5>

			<div class="checkbox-container checkbox-filter">
				{% for test in tests %}
					<label class="checkbox" title="{{test.description}}" >
						<input value="{{test.pk}}" type="checkbox" name="test[]" id="test-{{test.pk}}"  class="test category-{{test.category}} type-{{test.type}}"></input>
						{{test.name}}
					</label>
				{% endfor %}
			</div>
		</div>
	</div>

	<div class="span4">
		<div class="row-fluid">
			<div class="span6">
				<div id="date-container" class="control-container form-inline data-filter">
					<h5>Dates Filter</h5>
					<div id="chart-date-wrapper">
						<div class="date input-prepend input-append" id="from-date-wrapper" data-date="{{ from_date|date:'d-m-Y'}}" data-date-format="dd-mm-yyyy">
							{% spaceless %}
							<span for="from-date" id="from-date-label" class="add-on ">From:</span>
							<input type="text" id="from-date" class="date-only-input" value="{{ from_date|date:'d-m-Y'}}"></input><span class="add-on"><i class="icon-th"></i></span>
							{% endspaceless %}
						</div>
						<div class="date input-prepend input-append" id="to-date-wrapper" data-date="{{ to_date|date:'d-m-Y'}}" data-date-format="dd-mm-yyyy">
							{% spaceless %}
							<span for="to-date" id="to-date-label" class="add-on">To:</span>
							<input type="text" id="to-date" class="date-only-input" value="{{ to_date|date:'d-m-Y'}}"></input><span class="add-on"><i class="icon-th"></i></span>
							{% endspaceless %}
						</div>
					</div>
				</div>
			</div>
			<div class="span6">
				<div id="status-container" class="control-container">
					<h5>Review Status Filter</h5>
					<div id="status-checkboxes" class="checkbox-container">
						{% for status in statuses %}
							<label class="checkbox">
								<input type="checkbox" name="status[]" id="status-{{status.pk}}" value="{{status.pk}}" title="{{status.name}}" class="status status-{{status.pk}}" {% if status.export_by_default %}checked="checked"{% endif %}></input>
								{{status.name}}
							</label>
						{% endfor %}
					</div>
				</div>
			</div>
		</div>

		<div class="row-fluid">
			<div class="span12">
				<div id="chart-options" class="control-container form-inline">
					<h5>Chart Options</h5>
					<div class="row-fluid">
						<div class="span12">
							<label class="control-label" for="chart-type">
								Type:
								<select id="chart-type" class="inline input-medium">
									<option value="basic">Basic</option>
									{% if cc_available %}
										<option value="control">Control Chart</option>
									{% endif %}
								</select>
							</label>
						</div>
					</div>
					<div id="basic-chart-options" class="row-fluid">
						<div class="span12">
							<label class="control-label  basic-option" for="show-lines">
								Lines:
								<input type="checkbox" id="show-lines" checked="checked" />
							</label>
							<label class="control-label  basic-option" for="show-references">
								Refs:
								<input type="checkbox" id="show-references" checked="checked" />
							</label>
							<label class="control-label  basic-option" for="show-tolerances">
								Tols:
								<input type="checkbox" id="show-tolerances" checked="checked" />
							</label>
							<label class="control-label  basic-option" for="show-legend">
								Legend:
								<input type="checkbox" id="show-legend" />
							</label>
						</div>
					</div>
					{% if cc_available %}
						<div id="cc-chart-options">
							<label title="Set the subgroup size (Control Chart Only)" class="control-label  control-chart-option" for="subgroup-size">
								SG Size:
								<input type="number" min="1" step="1" value ="1" id="subgroup-size"  class="input-mini"/>
							</label>
							<label title="Set the number of subgroups for the baseline (Control Chart Only)" class="control-label control-chart-option" for="n-baseline-subgroups">
								# SG's:
								<input type="number" min="2" step="1" value ="2" id="n-baseline-subgroups" class="input-mini" />
							</label>
							<label title="Include a gaussian fit to histogrammed data (slow) (Control Chart Only)" class="control-label  control-chart-option" for="include-fit">
								Include Fit:
								<input type="checkbox" id="include-fit"/>
							</label>
						</div>
					{% endif %}
				</div>
			</div>
		</div>
		<div class="row-fluid">
			<div class="span8 input-prepend">
				{% spaceless %}
				<span class="add-on">Chart Link</span>
				<input type="text" class="input-medium" id="chart-url"/>
				{% endspaceless %}
			</div>

			<div class="span4" id="chart-actions">
				<button type="button" class="btn btn-primary pull-right" data-loading-text="Generating Chart..." id="gen-chart">Generate Chart</button>
			</div>
		</div>

	</div>
</div>


<div class="row-fluid">
	<div class="span12">
		<div id="chart-container" class="row-fluid">
			<div id="chart"  class="span12"></div>
		</div>
		<div id="control-chart-container" class="row-fluid">
			<div class="please-wait">Control Not Generated Yet</div>
		</div>
	</div>

</div>
<div class="row-fluid">
	<div class="span12 input-prepend">
		{% spaceless %}
		<span class="add-on">Link to this chart</span>
		<input type="text" class="input-xxlarge" id="chart-url"/>
		{% endspaceless %}
	</div>
</div>
<div class="row-fluid">
	<div class="span12">
		<div id="data-table-wrapper"></div>
	</div>
</div>


{% endblock %}



